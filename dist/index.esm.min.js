import t from"axios";function e(){return e=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},e.apply(null,arguments)}function r(t,e,r,n,o,a,u){try{var s=t[a](u),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function n(t){return function(){var e=this,n=arguments;return new Promise(function(o,a){var u=t.apply(e,n);function s(t){r(u,o,a,s,c,"next",t)}function c(t){r(u,o,a,s,c,"throw",t)}s(void 0)})}}var o,a={exports:{}},u={exports:{}};function s(){return o||(o=1,(t=u).exports=function(t,e){this.v=t,this.k=e},t.exports.__esModule=!0,t.exports.default=t.exports),u.exports;var t}var c,i,p={exports:{}},d={exports:{}};function f(){return c||(c=1,function(t){function e(r,n,o,a){var u=Object.defineProperty;try{u({},"",{})}catch(r){u=0}t.exports=e=function(t,r,n,o){function a(r,n){e(t,r,function(t){return this._invoke(r,n,t)})}r?u?u(t,r,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[r]=n:(a("next",0),a("throw",1),a("return",2))},t.exports.__esModule=!0,t.exports.default=t.exports,e(r,n,o,a)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(d)),d.exports}function l(){return i||(i=1,function(t){var e=f();function r(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var n,o,a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",s=a.toStringTag||"@@toStringTag";function c(t,r,a,u){var s=r&&r.prototype instanceof p?r:p,c=Object.create(s.prototype);return e(c,"_invoke",function(t,e,r){var a,u,s,c=0,p=r||[],d=!1,f={p:0,n:0,v:n,a:l,f:l.bind(n,4),d:function(t,e){return a=t,u=0,s=n,f.n=e,i}};function l(t,e){for(u=t,s=e,o=0;!d&&c&&!r&&o<p.length;o++){var r,a=p[o],l=f.p,v=a[2];t>3?(r=v===e)&&(s=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=n):a[0]<=l&&((r=t<2&&l<a[1])?(u=0,f.v=e,f.n=a[1]):l<v&&(r=t<3||a[0]>e||e>v)&&(a[4]=t,a[5]=e,f.n=v,u=0))}if(r||t>1)return i;throw d=!0,e}return function(r,p,v){if(c>1)throw TypeError("Generator is already running");for(d&&1===p&&l(p,v),u=p,s=v;(o=u<2?n:s)||!d;){a||(u?u<3?(u>1&&(f.n=-1),l(u,s)):f.n=s:f.v=s);try{if(c=2,a){if(u||(r="next"),o=a[r]){if(!(o=o.call(a,s)))throw TypeError("iterator result is not an object");if(!o.done)return o;s=o.value,u<2&&(u=0)}else 1===u&&(o=a.return)&&o.call(a),u<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),u=1);a=n}else if((o=(d=f.n<0)?s:t.call(e,f))!==i)break}catch(t){a=n,u=1,s=t}finally{c=1}}return{value:o,done:d}}}(t,a,u),!0),c}var i={};function p(){}function d(){}function f(){}o=Object.getPrototypeOf;var l=[][u]?o(o([][u]())):(e(o={},u,function(){return this}),o),v=f.prototype=p.prototype=Object.create(l);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,s,"GeneratorFunction")),t.prototype=Object.create(v),t}return d.prototype=f,e(v,"constructor",f),e(f,"constructor",d),d.displayName="GeneratorFunction",e(f,s,"GeneratorFunction"),e(v),e(v,s,"Generator"),e(v,u,function(){return this}),e(v,"toString",function(){return"[object Generator]"}),(t.exports=r=function(){return{w:c,m:m}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}(p)),p.exports}var v,m,x,g={exports:{}},h={exports:{}},b={exports:{}};function y(){return v||(v=1,function(t){var e=s(),r=f();t.exports=function t(n,o){function a(t,r,u,s){try{var c=n[t](r),i=c.value;return i instanceof e?o.resolve(i.v).then(function(t){a("next",t,u,s)},function(t){a("throw",t,u,s)}):o.resolve(i).then(function(t){c.value=t,u(c)},function(t){return a("throw",t,u,s)})}catch(t){s(t)}}var u;this.next||(r(t.prototype),r(t.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),r(this,"_invoke",function(t,e,r){function n(){return new o(function(e,n){a(t,r,e,n)})}return u=u?u.then(n,n):n()},!0)},t.exports.__esModule=!0,t.exports.default=t.exports}(b)),b.exports}function w(){return m||(m=1,function(t){var e=l(),r=y();t.exports=function(t,n,o,a,u){return new r(e().w(t,n,o,a),u||Promise)},t.exports.__esModule=!0,t.exports.default=t.exports}(h)),h.exports}var _,j={exports:{}};var k,O,S,T,P,E={exports:{}},G={exports:{}};function M(){return O||(O=1,function(t){var e=(k||(k=1,function(t){function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(G)),G.exports).default;t.exports=function(t){if(null!=t){var r=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(e(t)+" is not iterable")},t.exports.__esModule=!0,t.exports.default=t.exports}(E)),E.exports}var A=function(){if(P)return T;P=1;var t=(S||(S=1,function(t){var e=s(),r=l(),n=(x||(x=1,function(t){var e=w();t.exports=function(t,r,n,o,a){var u=e(t,r,n,o,a);return u.next().then(function(t){return t.done?t.value:u.next()})},t.exports.__esModule=!0,t.exports.default=t.exports}(g)),g.exports),o=w(),a=y(),u=function(){return _||(_=1,(t=j).exports=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},t.exports.__esModule=!0,t.exports.default=t.exports),j.exports;var t}(),c=M();function i(){var s=r(),p=s.m(i),d=(Object.getPrototypeOf?Object.getPrototypeOf(p):p.__proto__).constructor;function f(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))}var l={throw:1,return:2,break:3,continue:3};function v(t){var e,r;return function(n){e||(e={stop:function(){return r(n.a,2)},catch:function(){return n.v},abrupt:function(t,e){return r(n.a,l[t],e)},delegateYield:function(t,o,a){return e.resultName=o,r(n.d,c(t),a)},finish:function(t){return r(n.f,t)}},r=function(t,r,o){n.p=e.prev,n.n=e.next;try{return t(r,o)}finally{e.next=n.n}}),e.resultName&&(e[e.resultName]=n.v,e.resultName=void 0),e.sent=n.v,e.next=n.n;try{return t.call(this,e)}finally{n.p=e.prev,n.n=e.next}}}return(t.exports=i=function(){return{wrap:function(t,e,r,n){return s.w(v(t),e,r,n&&n.reverse())},isGeneratorFunction:f,mark:s.m,awrap:function(t,r){return new e(t,r)},AsyncIterator:a,async:function(t,e,r,a,u){return(f(e)?o:n)(v(t),e,r,a,u)},keys:u,values:c}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}(a)),a.exports)();T=t;try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}return T}(),z=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(A),I=["/rest/data/v2.0/scripts","/rest/metadata/v2.0/dx/logic/extpoints/openapi","/rest/data/v2.0/xobjects","/rest/data/v2/query","/rest/metadata/v2.0/xobjects/filter"],N=function(t){if("undefined"==typeof window)return I.includes(t);var e,r;try{if(t.startsWith("http://")||t.startsWith("https://")){var n=new URL(t);e=n.origin,r=n.pathname}else e=window.location.origin,r=t.split("?")[0];return e!==window.location.origin||!!I.some(function(t){return r===t||r.startsWith(t+"/")})||(console.warn("不允许使用当前接口: "+r+"。"),!1)}catch(e){return console.warn("API 地址解析失败，使用简单白名单检查:",e),I.includes(t)}},F=function(){var r=n(z.mark(function r(n){var o,a,u;return z.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,o=e({},n,{method:(null==n?void 0:n.method)||"GET",data:(null==n?void 0:n.data)||{},headers:e({"xsy-inner-source":"neo-open-api","Content-Type":"application/json"},null==n?void 0:n.headers),timeout:(null==n?void 0:n.timeout)||3e4}),N(o.url)){r.next=1;break}throw new Error("不允许使用的平台数据接口: "+o.url);case 1:return"GET"===(null==o?void 0:o.method)&&(o.params=(null==n?void 0:n.data)||{}),r.next=2,t(o);case 2:return a=r.sent,r.abrupt("return",(null==a?void 0:a.data)||{});case 3:throw r.prev=3,(u=r.catch(0)).response?console.error("接口请求报错 / 接口服务异常：",u.message):u.request?console.error("接口请求报错 / 接口未正常响应：",u.message):console.error("接口请求报错:",u,"，请求参数:",n),u;case 4:case"end":return r.stop()}},r,null,[[0,3]])}));return function(t){return r.apply(this,arguments)}}(),q=function(){var t=n(z.mark(function t(e){var r,n,o,a,u,s,c,i,p,d,f,l,v;return z.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=(r=e||{}).xObjectApiKey||"",o=Object.assign([],r.fields||[]),a=r.page||1,u=r.pageSize||10,o.includes("id")||o.push("id"),s=(a-1)*u,c="select "+o.join(",")+" from "+n,r.orderBy&&(c+=" order by "+r.orderBy),(r.page||r.pageSize)&&(c+=" limit "+s+","+u),t.prev=1,i={url:"/rest/data/v2/query",method:"GET",data:{q:c}},t.next=2,F(i);case 2:if(200!==(p=t.sent).code){t.next=3;break}return d=p.result||{},f=d.records,l=d.totalSize,t.abrupt("return",{status:!0,code:p.code,msg:p.msg||"获取业务对象数据列表成功",totalSize:l,data:f||[]});case 3:return t.abrupt("return",{status:!1,code:p.code,msg:p.msg||"获取业务对象数据列表失败",data:[]});case 4:return t.prev=4,v=t.catch(1),console.error("获取业务对象数据列表失败:",v),t.abrupt("return",{status:!1,msg:v.msg||v.message||"获取业务对象数据列表失败",data:[]});case 5:case"end":return t.stop()}},t,null,[[1,4]])}));return function(e){return t.apply(this,arguments)}}(),L=function(){var t=n(z.mark(function t(r,n){var o,a,u,s,c,i,p,d;return z.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=n||{},a="/rest/data/v2.0/xobjects/"+r+"/busiType",t.prev=1,u=e({},o,{url:a,method:"GET"}),t.next=2,F(u);case 2:if(200!==(s=t.sent).code&&"200"!==s.code){t.next=3;break}return c=s.data||{},i=c.records,p=c.totalSize,t.abrupt("return",{status:!0,code:s.code,msg:s.msg||"获取业务类型列表成功",totalSize:p,data:i||[]});case 3:return t.abrupt("return",{status:!1,code:s.code,msg:s.msg||"获取业务类型列表失败",data:[]});case 4:return t.prev=4,d=t.catch(1),console.error("获取业务类型列表失败:",d),t.abrupt("return",{status:!1,msg:d.msg||d.message||"获取业务类型列表失败",data:[]});case 5:case"end":return t.stop()}},t,null,[[1,4]])}));return function(e,r){return t.apply(this,arguments)}}(),R=function(){var t=n(z.mark(function t(r){var n,o,a,u,s,c,i,p,d,f,l;return z.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=null===(n=(o=r||{}).active)||void 0===n||n,u=o.custom,s="/rest/metadata/v2.0/xobjects/filter?active="+a,void 0!==u&&(s="/rest/metadata/v2.0/xobjects/filter?custom="+u+"&active="+a),t.prev=1,c=e({},o,{url:s,method:"GET"}),t.next=2,F(c);case 2:if("0"!==(i=t.sent).code&&0!==i.code&&"200"!==i.code&&200!==i.code){t.next=3;break}return p=i.data||{},d=p.records,f=p.totalSize,t.abrupt("return",{status:!0,code:i.code,msg:i.msg||"获取对象列表成功",totalSize:f,data:d||[]});case 3:return t.abrupt("return",{status:!1,code:i.code,msg:i.msg||"获取对象列表失败",data:[]});case 4:return t.prev=4,l=t.catch(1),console.error("获取对象列表失败:",l),t.abrupt("return",{status:!1,msg:l.msg||l.message||"获取对象列表失败",data:[]});case 5:case"end":return t.stop()}},t,null,[[1,4]])}));return function(e){return t.apply(this,arguments)}}(),K=function(){var t=n(z.mark(function t(r,n){var o,a,u,s,c,i;return z.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a="/rest/data/v2.0/xobjects/"+r,u=(o=n||{}).data||{},t.prev=1,s=e({},n,{url:a,method:o.method||"POST",data:{data:u}}),t.next=2,F(s);case 2:if("200"!==(c=t.sent).code&&200!==c.code){t.next=3;break}return t.abrupt("return",{status:!0,code:c.code,msg:c.msg||"创建业务数据成功",data:c.data||{}});case 3:return t.abrupt("return",{status:!1,code:c.code,msg:c.msg||"创建业务数据失败",data:{}});case 4:return t.prev=4,i=t.catch(1),console.error("创建业务数据失败:",i),t.abrupt("return",{status:!1,msg:i.msg||i.message||"创建业务数据失败",data:{}});case 5:case"end":return t.stop()}},t,null,[[1,4]])}));return function(e,r){return t.apply(this,arguments)}}(),W=function(){var t=n(z.mark(function t(r,n,o){var a,u,s,c,i,p;return z.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u="/rest/data/v2.0/xobjects/"+r+"/"+n,s=(a=o||{}).data||{},t.prev=1,c=e({},a,{url:u,method:a.method||"PATCH",data:{data:s}}),t.next=2,F(c);case 2:if("200"!==(i=t.sent).code&&200!==i.code){t.next=3;break}return t.abrupt("return",{status:!0,code:i.code,msg:i.msg||"更新业务数据成功",data:i.data||{}});case 3:return t.abrupt("return",{status:!1,code:i.code,msg:i.msg||"更新业务数据失败",data:{}});case 4:return t.prev=4,p=t.catch(1),console.error("更新业务数据失败:",p),t.abrupt("return",{status:!1,msg:p.msg||p.message||"更新业务数据失败",data:{}});case 5:case"end":return t.stop()}},t,null,[[1,4]])}));return function(e,r,n){return t.apply(this,arguments)}}(),B=function(){var t=n(z.mark(function t(r,n,o){var a,u,s,c,i,p,d;return z.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=r,u=n,s=o||{},"object"==typeof r&&r.xObjectApiKey&&(s=r.options||{},u=r.objectId,a=r.xObjectApiKey),c="/rest/data/v2.0/xobjects/"+a+"/"+u,t.prev=1,i=e({},s,{url:c,method:s.method||"GET"}),t.next=2,F(i);case 2:if("200"!==(p=t.sent).code&&200!==p.code){t.next=3;break}return t.abrupt("return",{status:!0,code:p.code,msg:p.msg||"获取业务数据成功",data:p.data||{}});case 3:return t.abrupt("return",{status:!1,code:p.code,msg:p.msg||"获取业务数据失败",data:{}});case 4:return t.prev=4,d=t.catch(1),console.error("获取业务数据失败:",d),t.abrupt("return",{status:!1,msg:d.msg||d.message||"获取业务数据失败",data:{}});case 5:case"end":return t.stop()}},t,null,[[1,4]])}));return function(e,r,n){return t.apply(this,arguments)}}(),C=function(){var t=n(z.mark(function t(r,n,o){var a,u,s,c,i;return z.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=o||{},u="/rest/data/v2.0/xobjects/"+r+"/"+n,t.prev=1,s=e({},a,{url:u,method:a.method||"DELETE"}),t.next=2,F(s);case 2:if("200"!==(c=t.sent).code&&200!==c.code){t.next=3;break}return t.abrupt("return",{status:!0,code:c.code,msg:c.msg||"删除业务数据成功"});case 3:return t.abrupt("return",{status:!1,code:c.code,msg:c.msg||"删除业务数据失败"});case 4:return t.prev=4,i=t.catch(1),console.error("删除业务数据失败:",i),t.abrupt("return",{status:!1,msg:i.msg||i.message||"删除业务数据失败"});case 5:case"end":return t.stop()}},t,null,[[1,4]])}));return function(e,r,n){return t.apply(this,arguments)}}(),D={query:q,getEntityTypeList:L,getEntityList:R,getDesc:function(){var t=n(z.mark(function t(r,n){var o,a,u,s,c;return z.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=n||{},a="/rest/data/v2.0/xobjects/"+r+"/description",t.prev=1,u=e({},n,{url:a,method:o.method||"GET"}),t.next=2,F(u);case 2:if("200"!==(s=t.sent).code&&200!==s.code){t.next=3;break}return t.abrupt("return",{status:!0,code:s.code,msg:s.msg||"获取业务对象描述数据成功",data:s.data||{}});case 3:return t.abrupt("return",{status:!1,code:s.code,msg:s.msg||"获取业务对象描述数据失败",data:{}});case 4:return t.prev=4,c=t.catch(1),console.error("获取业务对象描述数据失败:",c),t.abrupt("return",{status:!1,msg:c.msg||c.message||"获取业务对象描述数据失败",data:{}});case 5:case"end":return t.stop()}},t,null,[[1,4]])}));return function(e,r){return t.apply(this,arguments)}}(),create:K,update:W,get:B,delete:C},U={getList:function(){var t=n(z.mark(function t(e){var r,n,o,a,u,s,c,i,p,d;return z.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=(r=e||{}).pageNo||1,o=r.pageSize||1e3,a="/rest/metadata/v2.0/dx/logic/extpoints/openapi?pageNo="+n+"&pageSize="+o,t.prev=1,u={url:a,method:"GET"},t.next=2,F(u);case 2:if("0"!==(s=t.sent).code&&0!==s.code&&"200"!==s.code&&200!==s.code){t.next=3;break}return c=s.data||{},i=c.items,p=c.count,t.abrupt("return",{status:!0,code:s.code,msg:s.msg||"获取自定义API列表成功",totalSize:p,data:i||[]});case 3:return t.abrupt("return",{status:!1,code:s.code,msg:s.msg||"获取自定义API列表失败",data:[]});case 4:return t.prev=4,d=t.catch(1),console.error("获取自定义API列表失败:",d),t.abrupt("return",{status:!1,msg:d.msg||d.message||"获取自定义API列表失败",data:[]});case 5:case"end":return t.stop()}},t,null,[[1,4]])}));return function(e){return t.apply(this,arguments)}}(),run:function(){var t=n(z.mark(function t(r){var n,o,a,u,s,c,i;return z.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=(n=r||{}).apiUrl||"",a=n.methodType||n.method||"POST",u=n.data||{},t.prev=1,s=e({},r,{url:o,method:a,data:u}),t.next=2,F(s);case 2:return c=t.sent,t.abrupt("return",e({status:!0},c));case 3:return t.prev=3,i=t.catch(1),console.error("执行自定义API失败:",i),t.abrupt("return",{status:!1,msg:i.msg||i.message||"执行自定义API失败",data:{}});case 4:case"end":return t.stop()}},t,null,[[1,3]])}));return function(e){return t.apply(this,arguments)}}()},H=F;export{F as axiosFetcher,U as customApi,H as request,D as xObject};
